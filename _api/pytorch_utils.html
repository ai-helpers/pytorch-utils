<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pytorch_utils package &mdash; AI Helpers PyTorch Utils 0.1.0a1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=49b5e7b8"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="pytorch_utils" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2E68D9" >

          
          
          <a href="../index.html">
            
          </a>
              <div class="version">
                0.1.0a1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pytorch_utils</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">pytorch_utils package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils.data_modules">pytorch_utils.data_modules module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule"><code class="docutils literal notranslate"><span class="pre">AugmentedBernoulliDataModule</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils.dataset_configurations">pytorch_utils.dataset_configurations module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.dataset_configurations.DataSplitConfig"><code class="docutils literal notranslate"><span class="pre">DataSplitConfig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig"><code class="docutils literal notranslate"><span class="pre">DataAugmentationConfig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig"><code class="docutils literal notranslate"><span class="pre">AugmentedBernoulliDatasetConfig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs"><code class="docutils literal notranslate"><span class="pre">AugmentedBernoulliDatasetConfigs</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils.datasets">pytorch_utils.datasets module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.datasets.MLStage"><code class="docutils literal notranslate"><span class="pre">MLStage</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.datasets.AugmentedBernoulliDataset"><code class="docutils literal notranslate"><span class="pre">AugmentedBernoulliDataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils.exceptions">pytorch_utils.exceptions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.MLError"><code class="docutils literal notranslate"><span class="pre">MLError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.CatalogError"><code class="docutils literal notranslate"><span class="pre">CatalogError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.InvalidDataFormatError"><code class="docutils literal notranslate"><span class="pre">InvalidDataFormatError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.LocalDirNotWriteableException"><code class="docutils literal notranslate"><span class="pre">LocalDirNotWriteableException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.MissingConfigFileException"><code class="docutils literal notranslate"><span class="pre">MissingConfigFileException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.BadCLIParameterException"><code class="docutils literal notranslate"><span class="pre">BadCLIParameterException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.BadConfigException"><code class="docutils literal notranslate"><span class="pre">BadConfigException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.BadConfigLogLevelException"><code class="docutils literal notranslate"><span class="pre">BadConfigLogLevelException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.BadConfigSparkMasterException"><code class="docutils literal notranslate"><span class="pre">BadConfigSparkMasterException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.BadConfigPathException"><code class="docutils literal notranslate"><span class="pre">BadConfigPathException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.BadConfigMissingInputException"><code class="docutils literal notranslate"><span class="pre">BadConfigMissingInputException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.BadConfigMissingOutputException"><code class="docutils literal notranslate"><span class="pre">BadConfigMissingOutputException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.TaskNotFoundError"><code class="docutils literal notranslate"><span class="pre">TaskNotFoundError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.MissingDatasetError"><code class="docutils literal notranslate"><span class="pre">MissingDatasetError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.DataSetError"><code class="docutils literal notranslate"><span class="pre">DataSetError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.MissingConfigException"><code class="docutils literal notranslate"><span class="pre">MissingConfigException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.BadConfigFormatException"><code class="docutils literal notranslate"><span class="pre">BadConfigFormatException</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.InconsistentDatasetConfigurations"><code class="docutils literal notranslate"><span class="pre">InconsistentDatasetConfigurations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.NotMonotone"><code class="docutils literal notranslate"><span class="pre">NotMonotone</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.NotNonDecreasing"><code class="docutils literal notranslate"><span class="pre">NotNonDecreasing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.exceptions.NotNonIncreasing"><code class="docutils literal notranslate"><span class="pre">NotNonIncreasing</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils.metrics">pytorch_utils.metrics module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.metrics.WeightedMeanSquaredError"><code class="docutils literal notranslate"><span class="pre">WeightedMeanSquaredError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.metrics.WeightedMeanAbsoluteError"><code class="docutils literal notranslate"><span class="pre">WeightedMeanAbsoluteError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.metrics.WeightedBinaryCalibrationError"><code class="docutils literal notranslate"><span class="pre">WeightedBinaryCalibrationError</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils.miscellaneous">pytorch_utils.miscellaneous module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.miscellaneous.class_full_name"><code class="docutils literal notranslate"><span class="pre">class_full_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.miscellaneous.sort_hashable"><code class="docutils literal notranslate"><span class="pre">sort_hashable()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.miscellaneous.DataclassType"><code class="docutils literal notranslate"><span class="pre">DataclassType</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils.modules">pytorch_utils.modules module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.LinearNonNeg"><code class="docutils literal notranslate"><span class="pre">LinearNonNeg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.BatchNorm1dNonNeg"><code class="docutils literal notranslate"><span class="pre">BatchNorm1dNonNeg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.LinearSemiNonNeg"><code class="docutils literal notranslate"><span class="pre">LinearSemiNonNeg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.BiLinearSemiNonNeg"><code class="docutils literal notranslate"><span class="pre">BiLinearSemiNonNeg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.Partitioned"><code class="docutils literal notranslate"><span class="pre">Partitioned</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.ShiftedEmbedding"><code class="docutils literal notranslate"><span class="pre">ShiftedEmbedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.MeanImputationEmbedding"><code class="docutils literal notranslate"><span class="pre">MeanImputationEmbedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.MonotoneBernoulliProbability"><code class="docutils literal notranslate"><span class="pre">MonotoneBernoulliProbability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.modules.ProbabilityPredictor"><code class="docutils literal notranslate"><span class="pre">ProbabilityPredictor</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils.utils">pytorch_utils.utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.utils.CategoricalFeatureEmbedding"><code class="docutils literal notranslate"><span class="pre">CategoricalFeatureEmbedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.utils.get_embedding_size"><code class="docutils literal notranslate"><span class="pre">get_embedding_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pytorch_utils.utils.assert_monotone"><code class="docutils literal notranslate"><span class="pre">assert_monotone()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-pytorch_utils">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2E68D9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AI Helpers PyTorch Utils</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">pytorch_utils</a></li>
      <li class="breadcrumb-item active">pytorch_utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_api/pytorch_utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pytorch-utils-package">
<h1>pytorch_utils package<a class="headerlink" href="#pytorch-utils-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pytorch_utils.data_modules">
<span id="pytorch-utils-data-modules-module"></span><h2>pytorch_utils.data_modules module<a class="headerlink" href="#module-pytorch_utils.data_modules" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AugmentedBernoulliDataModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmented_bernoulli_dataset_configs:</span> <span class="pre">~pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessing_pipeline:</span> <span class="pre">~sklearn.pipeline.Pipeline</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataloader_params:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataloader_params:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataloader_params:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_dataloader_params:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_module_logger:</span> <span class="pre">~pytorch_utils.logging.loggers.Logger</span> <span class="pre">=</span> <span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessing_pipeline_logger:</span> <span class="pre">~pytorch_utils.logging.loggers.Logger</span> <span class="pre">=</span> <span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data_per_node:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningDataModule</span></code></p>
<p>For prediction: attributes <cite>prediction_df</cite> (and
optionally <cite>prediction_scaling_factors</cite>,
<cite>prediction_min_augmented_value</cite> and
<cite>prediction_max_augmented_value</cite>) must be set as desired.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.preprocessing_pandas_collate_fn">
<span class="sig-name descname"><span class="pre">preprocessing_pandas_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrameRow</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.preprocessing_pandas_collate_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.preprocessing_pandas_collate_fn" title="Link to this definition"></a></dt>
<dd><p>More computationally efficient than using <cite>collate_fn=lambda batch: pd.concat(batch, axis=0, sort=True)</cite> and
setting <cite>fitted_transformers_pipeline=self.preprocessing_pipeline</cite> in AugmentedBernoulliDataset. This
vectorized the transform operations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.transform" title="Link to this definition"></a></dt>
<dd><p>Implicit assumption in the following implementation: the preprocessing pipeline does not
modify the number of rows.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.transform_to_tensors">
<span class="sig-name descname"><span class="pre">transform_to_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.transform_to_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.transform_to_tensors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.augment_transform_to_tensors">
<span class="sig-name descname"><span class="pre">augment_transform_to_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation_scaling_factors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([1.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_augmented_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_augmented_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.augment_transform_to_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.augment_transform_to_tensors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.format_to_tensors">
<span class="sig-name descname"><span class="pre">format_to_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transformed_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.format_to_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.format_to_tensors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.is_preprocessing_pipeline_fitted">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_preprocessing_pipeline_fitted</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.is_preprocessing_pipeline_fitted" title="Link to this definition"></a></dt>
<dd><p>Boolean indicating whether pipeline is fitted</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.fit_preprocessing_pipeline">
<span class="sig-name descname"><span class="pre">fit_preprocessing_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">refit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.fit_preprocessing_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.fit_preprocessing_pipeline" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.input_features_dtypes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_features_dtypes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Series</span></em><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.input_features_dtypes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.output_features_dtypes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_features_dtypes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Series</span></em><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.output_features_dtypes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.output_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_features</span></span><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.output_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.output_real_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_real_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.output_real_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.output_categorical_features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_categorical_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.output_categorical_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="Link to this definition"></a></dt>
<dd><p>Use this to download and prepare data. Downloading and saving data with multiple processes (distributed
settings) will result in corrupted data. Lightning ensures this method is called only within a single process,
so you can safely add your downloading logic within.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>DO NOT set state to the model (use <code class="docutils literal notranslate"><span class="pre">setup</span></code> instead)
since this is NOT called on every device</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">prepare_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># good</span>
    <span class="n">download_data</span><span class="p">()</span>
    <span class="n">tokenize</span><span class="p">()</span>
    <span class="n">etc</span><span class="p">()</span>

    <span class="c1"># bad</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split</span> <span class="o">=</span> <span class="n">data_split</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">some_state</span> <span class="o">=</span> <span class="n">some_other_state</span><span class="p">()</span>
</pre></div>
</div>
<p>In a distributed environment, <code class="docutils literal notranslate"><span class="pre">prepare_data</span></code> can be called in two ways
(using <span class="xref std std-ref">prepare_data_per_node</span>)</p>
<ol class="arabic simple">
<li><p>Once per node. This is the default and is only called on LOCAL_RANK=0.</p></li>
<li><p>Once in total. Only called on GLOBAL_RANK=0.</p></li>
</ol>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># DEFAULT</span>
<span class="c1"># called once per node on LOCAL_RANK=0 of that node</span>
<span class="k">class</span> <span class="nc">LitDataModule</span><span class="p">(</span><span class="n">LightningDataModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_data_per_node</span> <span class="o">=</span> <span class="kc">True</span>


<span class="c1"># call on GLOBAL_RANK=0 (great for shared file systems)</span>
<span class="k">class</span> <span class="nc">LitDataModule</span><span class="p">(</span><span class="n">LightningDataModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_data_per_node</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>This is called before requesting the dataloaders:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">()</span>
<span class="n">initialize_distributed</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">stage</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">val_dataloader</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">test_dataloader</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict_dataloader</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup" title="Link to this definition"></a></dt>
<dd><p>Called at the beginning of fit (train + validate), validate, test, or predict. This is a good hook when you
need to build models dynamically or adjust something about them. This hook is called on every process when
using DDP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stage</strong> – either <code class="docutils literal notranslate"><span class="pre">'fit'</span></code>, <code class="docutils literal notranslate"><span class="pre">'validate'</span></code>, <code class="docutils literal notranslate"><span class="pre">'test'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'predict'</span></code></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LitModel</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">prepare_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">download_data</span><span class="p">()</span>
        <span class="n">tokenize</span><span class="p">()</span>

        <span class="c1"># don&#39;t do this</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">something</span> <span class="o">=</span> <span class="k">else</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stage</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">num_classes</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup_datasets">
<span class="sig-name descname"><span class="pre">setup_datasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ml_stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">MLStage.fit</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MLStage.validate</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MLStage.test</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MLStage.predict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.setup_datasets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup_datasets" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.batch_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.train_dataloader">
<span class="sig-name descname"><span class="pre">train_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.train_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.train_dataloader" title="Link to this definition"></a></dt>
<dd><p>An iterable or collection of iterables specifying training samples.</p>
<p>For more information about multiple dataloaders, see this <span class="xref std std-ref">section</span>.</p>
<p>The dataloader you return will not be reloaded unless you set
<a href="#id1"><span class="problematic" id="id2">:paramref:`~pytorch_lightning.trainer.trainer.Trainer.reload_dataloaders_every_n_epochs`</span></a> to
a positive integer.</p>
<p>For data processing use the following pattern:</p>
<blockquote>
<div><ul class="simple">
<li><p>download in <a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></a></p></li>
<li><p>process and split in <a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>However, the above are only necessary for distributed processing.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>do not assign state in prepare_data</p>
</div>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></p></li>
<li><p><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning tries to add the correct sampler for distributed and arbitrary hardware.
There is no need to set it yourself.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.val_dataloader">
<span class="sig-name descname"><span class="pre">val_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.val_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.val_dataloader" title="Link to this definition"></a></dt>
<dd><p>An iterable or collection of iterables specifying validation samples.</p>
<p>For more information about multiple dataloaders, see this <span class="xref std std-ref">section</span>.</p>
<p>The dataloader you return will not be reloaded unless you set
<a href="#id3"><span class="problematic" id="id4">:paramref:`~pytorch_lightning.trainer.trainer.Trainer.reload_dataloaders_every_n_epochs`</span></a> to
a positive integer.</p>
<p>It’s recommended that all data downloads and preparation happen in <a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></a>.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">validate()</span></code></p></li>
<li><p><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning tries to add the correct sampler for distributed and arbitrary hardware
There is no need to set it yourself.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t need a validation dataset and a <code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code>, you don’t need to
implement this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.test_dataloader">
<span class="sig-name descname"><span class="pre">test_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.test_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.test_dataloader" title="Link to this definition"></a></dt>
<dd><p>An iterable or collection of iterables specifying test samples.</p>
<p>For more information about multiple dataloaders, see this <span class="xref std std-ref">section</span>.</p>
<p>For data processing use the following pattern:</p>
<blockquote>
<div><ul class="simple">
<li><p>download in <a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></a></p></li>
<li><p>process and split in <a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>However, the above are only necessary for distributed processing.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>do not assign state in prepare_data</p>
</div>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">test()</span></code></p></li>
<li><p><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning tries to add the correct sampler for distributed and arbitrary hardware.
There is no need to set it yourself.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t need a test dataset and a <code class="xref py py-meth docutils literal notranslate"><span class="pre">test_step()</span></code>, you don’t need to implement
this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.predict_dataloader">
<span class="sig-name descname"><span class="pre">predict_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.predict_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.predict_dataloader" title="Link to this definition"></a></dt>
<dd><p>An iterable or collection of iterables specifying prediction samples.</p>
<p>For more information about multiple dataloaders, see this <span class="xref std std-ref">section</span>.</p>
<p>It’s recommended that all data downloads and preparation happen in <a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></a>.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code></p></li>
<li><p><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.prepare_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_data()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lightning tries to add the correct sampler for distributed and arbitrary hardware
There is no need to set it yourself.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code> or a sequence of them specifying prediction samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.clear_data">
<span class="sig-name descname"><span class="pre">clear_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.clear_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.clear_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.log" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.data_modules.AugmentedBernoulliDataModule.load_from_checkpoint">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule"><span class="pre">AugmentedBernoulliDataModule</span></a></span></span><a class="reference internal" href="../_modules/pytorch_utils/data_modules.html#AugmentedBernoulliDataModule.load_from_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule.load_from_checkpoint" title="Link to this definition"></a></dt>
<dd><p>We override this method to correct a bug with <cite>map_location</cite> argument.
See Github issue: <a class="reference external" href="https://github.com/Lightning-AI/lightning/issues/17945">https://github.com/Lightning-AI/lightning/issues/17945</a></p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pytorch_utils.dataset_configurations">
<span id="pytorch-utils-dataset-configurations-module"></span><h2>pytorch_utils.dataset_configurations module<a class="headerlink" href="#module-pytorch_utils.dataset_configurations" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataSplitConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DataSplitConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_proportion:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_proportion:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_proportion:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stratify:</span> <span class="pre">~typing.List[str]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~pytorch_utils.logging.loggers.Logger</span> <span class="pre">=</span> <span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataSplitConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataSplitConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SingleLoggerDataclassLoggable</span></code></p>
<p>Configuration used to specify train, validation and test splits.
The proportions should all lie in [0,1], with their sum smaller or equal to 1.
In case the sum is strictly smaller than 1, only a random subset of the data is used.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataSplitConfig.training_proportion">
<span class="sig-name descname"><span class="pre">training_proportion</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataSplitConfig.training_proportion" title="Link to this definition"></a></dt>
<dd><p>proportion of dataframe to be used as training samples</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, default=1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataSplitConfig.validation_proportion">
<span class="sig-name descname"><span class="pre">validation_proportion</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataSplitConfig.validation_proportion" title="Link to this definition"></a></dt>
<dd><p>proportion of dataframe to be used as validation samples</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, default=0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataSplitConfig.test_proportion">
<span class="sig-name descname"><span class="pre">test_proportion</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataSplitConfig.test_proportion" title="Link to this definition"></a></dt>
<dd><p>proportion of dataframe to be used as test samples</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, default=0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataSplitConfig.random_seed">
<span class="sig-name descname"><span class="pre">random_seed</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataSplitConfig.random_seed" title="Link to this definition"></a></dt>
<dd><p>random seed used for random splitting</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[int], default=None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataSplitConfig.stratify">
<span class="sig-name descname"><span class="pre">stratify</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataSplitConfig.stratify" title="Link to this definition"></a></dt>
<dd><p>list of column names used to stratify the data (see also sklearn.model_selection.train_test_split)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[List[str]], default=None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">training_proportion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">validation_proportion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">test_proportion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">random_seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">stratify</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataSplitConfig.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataSplitConfig.logger" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataSplitConfig.train_valid_test_split">
<span class="sig-name descname"><span class="pre">train_valid_test_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Index</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Index</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Index</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataSplitConfig.train_valid_test_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataSplitConfig.train_valid_test_split" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DataAugmentationConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmented_col:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factors:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">=</span> <span class="pre">array([1.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~pytorch_utils.logging.loggers.Logger</span> <span class="pre">=</span> <span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataAugmentationConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SingleLoggerDataclassLoggable</span></code></p>
<p>Configuration used to specify data augmentation on specific column (<cite>augmented_col</cite>).
The idea of this data augmentation is to duplicate the data several times, with only <cite>augmented_col</cite> changed
by multiplying the original values with a scaling factor.</p>
<p>This can be useful when there is some monotone relationship between a covariate (<cite>augmented_col</cite>) and the
success of an event (0=success, 1=event).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.augmented_col">
<span class="sig-name descname"><span class="pre">augmented_col</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.augmented_col" title="Link to this definition"></a></dt>
<dd><p>Name of column to augment</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.scaling_factors">
<span class="sig-name descname"><span class="pre">scaling_factors</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.scaling_factors" title="Link to this definition"></a></dt>
<dd><p>Numpy array of floats corresponding to scaling factors used for data augmentation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">augmented_col</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">scaling_factors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">array([1.])</span></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.min_value">
<span class="sig-name descname"><span class="pre">min_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-inf</span></em><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.min_value" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.max_value">
<span class="sig-name descname"><span class="pre">max_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.max_value" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.logger" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.augment_data">
<span class="sig-name descname"><span class="pre">augment_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataAugmentationConfig.augment_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.augment_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.scaling_filter">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scaling_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataAugmentationConfig.scaling_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.scaling_filter" title="Link to this definition"></a></dt>
<dd><p>Filter used to drop scaled values that are outside the range [min_value, max_value].
See method <cite>scale_col</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.scale_col">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scale_col</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataAugmentationConfig.scale_col"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.scale_col" title="Link to this definition"></a></dt>
<dd><p>Return pandas dataframe identical to <cite>data</cite> with column <cite>col</cite> scaled by <cite>scaling_factor</cite>.
The scaled values that are outside the range [min_value, max_value] are dropped.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.scaling_length">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scaling_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataAugmentationConfig.scaling_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.scaling_length" title="Link to this definition"></a></dt>
<dd><p>Length of the pandas dataframe obtained when calling method <cite>scale_col</cite> with the exact same input.
The implementation does not require explicitly building the dataframe.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.augmentation_length">
<span class="sig-name descname"><span class="pre">augmentation_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataAugmentationConfig.augmentation_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.augmentation_length" title="Link to this definition"></a></dt>
<dd><p>Length of the pandas dataframe obtained when calling method <cite>augment_data</cite> with the exact same input.
The implementation does not require explicitly building the dataframe.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.DataAugmentationConfig.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#DataAugmentationConfig.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig.log" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AugmentedBernoulliDatasetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">~pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_success:</span> <span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_augmentation_config:</span> <span class="pre">~pytorch_utils.dataset_configurations.DataAugmentationConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_config:</span> <span class="pre">~pytorch_utils.dataset_configurations.DataSplitConfig</span> <span class="pre">=</span> <span class="pre">DataSplitConfig(training_proportion=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_proportion=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_proportion=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stratify=None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~pytorch_utils.logging.loggers.Logger</span> <span class="pre">=</span> <span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SingleLoggerDataclassLoggable</span></code></p>
<p>Dataset configuration for augmented Bernoulli samples (binary outcomes: successful or not).
There are 2 ways to construct an instance of <cite>AugmentedBernoulliDatasetConfig</cite>:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>either by calling the constructor and passing a pandas dataframe (with optional meatada) as input</p></li>
<li><p>or by calling <cite>class method `from_meta_dataframe</cite> and passing a delta table as input</p></li>
</ol>
</div></blockquote>
<p>Method 1 is preferred for testing/debugging/prototyping while method 2 is preferred for
production and traceable experimentations (clean metadata, etc…).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.data" title="Link to this definition"></a></dt>
<dd><p>The Pandas dataframe containing the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.is_success">
<span class="sig-name descname"><span class="pre">is_success</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.is_success" title="Link to this definition"></a></dt>
<dd><p>Whether the samples correspond to successful events or not</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.split_config">
<span class="sig-name descname"><span class="pre">split_config</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.split_config" title="Link to this definition"></a></dt>
<dd><p>The configuration for splitting between train, validation and test</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pytorch_utils.dataset_configurations.DataSplitConfig" title="pytorch_utils.dataset_configurations.DataSplitConfig">DataSplitConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.data_augmentation_config">
<span class="sig-name descname"><span class="pre">data_augmentation_config</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.data_augmentation_config" title="Link to this definition"></a></dt>
<dd><p>The configuration for data augmentation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig" title="pytorch_utils.dataset_configurations.DataAugmentationConfig">DataAugmentationConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.metadata" title="Link to this definition"></a></dt>
<dd><p>Any information regarding the source data that we wish to track/save</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any], default={}</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pd.DataFrame</span></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">is_success</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">data_augmentation_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig" title="pytorch_utils.dataset_configurations.DataAugmentationConfig"><span class="pre">DataAugmentationConfig</span></a></em><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">split_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#pytorch_utils.dataset_configurations.DataSplitConfig" title="pytorch_utils.dataset_configurations.DataSplitConfig"><span class="pre">DataSplitConfig</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">DataSplitConfig(training_proportion=1.0,</span> <span class="pre">validation_proportion=0.0,</span> <span class="pre">test_proportion=0.0,</span> <span class="pre">random_seed=None,</span> <span class="pre">stratify=None)</span></em><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.logger" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.from_meta_dataframe">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_meta_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">meta_df:</span> <span class="pre">Any[pyspark.sql.DataFrame],</span> <span class="pre">is_success:</span> <span class="pre">bool,</span> <span class="pre">data_augmentation_config:</span> <span class="pre">DataAugmentationConfig,</span> <span class="pre">split_config:</span> <span class="pre">DataSplitConfig,</span> <span class="pre">logger:</span> <span class="pre">Logger</span> <span class="pre">=</span> <span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;,</span> <span class="pre">spark_filter:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">pandas_formatter:</span> <span class="pre">PandasFormatter</span> <span class="pre">=</span> <span class="pre">PandasIdentityFormatter()</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig" title="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig"><span class="pre">AugmentedBernoulliDatasetConfig</span></a></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfig.from_meta_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.from_meta_dataframe" title="Link to this definition"></a></dt>
<dd><p>Use this method to construct an instance of <cite>AugmentedBernoulliDatasetConfig</cite> directly from a delta table
with proper metadata.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.delta_table">
<span class="sig-name descname"><span class="pre">delta_table</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.delta_table" title="Link to this definition"></a></dt>
<dd><p>The delta table containing the data.
To use a previous version of the data, call <cite>restoreToVersion(version: int)</cite>
on <cite>delta_table</cite> before passing it to <cite>AugmentedBernoulliDatasetConfig</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>delta.tables.DeltaTable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">is_success</span></span><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd><p>Whether the samples correspond to successful events or not</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">split_config</span></span><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>The configuration for splitting between train, validation and test</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pytorch_utils.dataset_configurations.DataSplitConfig" title="pytorch_utils.dataset_configurations.DataSplitConfig">DataSplitConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">data_augmentation_config</span></span><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>The configuration for data augmentation</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pytorch_utils.dataset_configurations.DataAugmentationConfig" title="pytorch_utils.dataset_configurations.DataAugmentationConfig">DataAugmentationConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.pandas_formatter">
<span class="sig-name descname"><span class="pre">pandas_formatter</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.pandas_formatter" title="Link to this definition"></a></dt>
<dd><p>Any formatting on pandas data (cast dtypes, etc…).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PandasFormatter</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfig.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.sample" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.training_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">training_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.training_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.training_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">training_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.training_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.validation_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validation_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.validation_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.validation_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validation_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.validation_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.test_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">test_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.test_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.test_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">test_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.test_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_training_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_training_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_training_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_training_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_training_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_training_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_validation_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_validation_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_validation_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_validation_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_validation_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_validation_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_test_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_test_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_test_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_test_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_test_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_test_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_col">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_col</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.augmented_col" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.data_augmentation_scaling_factors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_augmentation_scaling_factors</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.data_augmentation_scaling_factors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.columns">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">columns</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.columns" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.dtypes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtypes</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.dtypes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.clear_data">
<span class="sig-name descname"><span class="pre">clear_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig" title="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig"><span class="pre">AugmentedBernoulliDatasetConfig</span></a></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfig.clear_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.clear_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfig.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig.log" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AugmentedBernoulliDatasetConfigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">augmented_bernoulli_dataset_configs=typing.List[pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig],</span> <span class="pre">label_col:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'success_labels',</span> <span class="pre">labels_dtype:</span> <span class="pre">~typing.Type[~numpy.int32]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.int32'&gt;,</span> <span class="pre">sample_weight_col:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">logger:</span> <span class="pre">~pytorch_utils.logging.loggers.Logger</span> <span class="pre">=</span> <span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">UserList</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.check_compatibility">
<span class="sig-name descname"><span class="pre">check_compatibility</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfigs.check_compatibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.check_compatibility" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.augmented_col">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">augmented_col</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.augmented_col" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.columns">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">columns</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.columns" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.dtypes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtypes</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.dtypes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfigs.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.sample" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_training_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_training_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_training_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_training_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_training_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_training_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_validation_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_validation_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_validation_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_validation_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_validation_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_validation_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_test_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_test_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_test_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_test_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_test_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_test_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_augmented_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_augmented_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_training_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_augmented_training_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_training_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_training_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_augmented_training_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_training_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_validation_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_augmented_validation_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_validation_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_validation_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_augmented_validation_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_validation_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_test_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_augmented_test_data</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_test_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_test_data_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_augmented_test_data_length</span></span><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.all_augmented_test_data_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.clear_data">
<span class="sig-name descname"><span class="pre">clear_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs" title="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs"><span class="pre">AugmentedBernoulliDatasetConfigs</span></a></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfigs.clear_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.clear_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/dataset_configurations.html#AugmentedBernoulliDatasetConfigs.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfigs.log" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pytorch_utils.datasets">
<span id="pytorch-utils-datasets-module"></span><h2>pytorch_utils.datasets module<a class="headerlink" href="#module-pytorch_utils.datasets" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.datasets.MLStage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MLStage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/datasets.html#MLStage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.datasets.MLStage" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.MLStage.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#pytorch_utils.datasets.MLStage.fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.MLStage.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#pytorch_utils.datasets.MLStage.validate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.MLStage.test">
<span class="sig-name descname"><span class="pre">test</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#pytorch_utils.datasets.MLStage.test" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.MLStage.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#pytorch_utils.datasets.MLStage.predict" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AugmentedBernoulliDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ListDataFrameRows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_success</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmented_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitted_preprocessing_pipeline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_augmentation_scaling_factors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([1.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'success_labels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">dtype('int32')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_augmented_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_augmented_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/datasets.html#AugmentedBernoulliDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Implements storage-efficient data augmentation of Bernoulli samples
(binary outcomes: successful or not) as well as data transformations
(e.g., scaling, encoding, …).
If <cite>is_success</cite> is set to None, only features are generated (labels are dropped).
This is useful for prediction sets.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ListDataFrameRows</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.is_success">
<span class="sig-name descname"><span class="pre">is_success</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.is_success" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.augmented_col">
<span class="sig-name descname"><span class="pre">augmented_col</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.augmented_col" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.fitted_preprocessing_pipeline">
<span class="sig-name descname"><span class="pre">fitted_preprocessing_pipeline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Pipeline</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.fitted_preprocessing_pipeline" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.data_augmentation_scaling_factors">
<span class="sig-name descname"><span class="pre">data_augmentation_scaling_factors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">array([1.])</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.data_augmentation_scaling_factors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.label_col">
<span class="sig-name descname"><span class="pre">label_col</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'success_labels'</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.label_col" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.labels_dtype">
<span class="sig-name descname"><span class="pre">labels_dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">dtype('int32')</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.labels_dtype" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.sample_weight_col">
<span class="sig-name descname"><span class="pre">sample_weight_col</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.sample_weight_col" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.min_augmented_value">
<span class="sig-name descname"><span class="pre">min_augmented_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-inf</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.min_augmented_value" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.max_augmented_value">
<span class="sig-name descname"><span class="pre">max_augmented_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.max_augmented_value" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig" title="pytorch_utils.dataset_configurations.AugmentedBernoulliDatasetConfig"><span class="pre">AugmentedBernoulliDatasetConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ml_stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">MLStage.fit</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MLStage.validate</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MLStage.test</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitted_preprocessing_pipeline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'success_labels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">dtype('int32')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pytorch_utils.datasets.AugmentedBernoulliDataset" title="pytorch_utils.datasets.AugmentedBernoulliDataset"><span class="pre">AugmentedBernoulliDataset</span></a></span></span><a class="reference internal" href="../_modules/pytorch_utils/datasets.html#AugmentedBernoulliDataset.from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.from_config" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.dataframe">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dataframe</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.dataframe" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.clear_data">
<span class="sig-name descname"><span class="pre">clear_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pytorch_utils.datasets.AugmentedBernoulliDataset" title="pytorch_utils.datasets.AugmentedBernoulliDataset"><span class="pre">AugmentedBernoulliDataset</span></a></span></span><a class="reference internal" href="../_modules/pytorch_utils/datasets.html#AugmentedBernoulliDataset.clear_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.clear_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.raw_feature_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">raw_feature_names</span></span><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.raw_feature_names" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.datasets.AugmentedBernoulliDataset.transformed_feature_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transformed_feature_names</span></span><a class="headerlink" href="#pytorch_utils.datasets.AugmentedBernoulliDataset.transformed_feature_names" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pytorch_utils.exceptions">
<span id="pytorch-utils-exceptions-module"></span><h2>pytorch_utils.exceptions module<a class="headerlink" href="#module-pytorch_utils.exceptions" title="Link to this heading"></a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.MLError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MLError</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#MLError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.MLError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception class from which every exception in this library will derive.
It enables other projects using this library to catch all errors coming
from the library with a single “except” statement</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.CatalogError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CatalogError</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#CatalogError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.CatalogError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when the catalog is not valid</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.InvalidDataFormatError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InvalidDataFormatError</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#InvalidDataFormatError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.InvalidDataFormatError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when the catalog is not valid</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.LocalDirNotWriteableException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LocalDirNotWriteableException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#LocalDirNotWriteableException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.LocalDirNotWriteableException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when the local directory is not writeable</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.MissingConfigFileException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MissingConfigFileException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#MissingConfigFileException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.MissingConfigFileException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when a given configuration file cannot be found</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.BadCLIParameterException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BadCLIParameterException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#BadCLIParameterException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.BadCLIParameterException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when there is an issue with a parameter
in the CLI (commnand-line interface)</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.BadConfigException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BadConfigException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#BadConfigException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.BadConfigException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when a configuration file cannot be loaded, for instance
due to wrong syntax or poor formatting.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.BadConfigLogLevelException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BadConfigLogLevelException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#BadConfigLogLevelException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.BadConfigLogLevelException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.BadConfigException" title="pytorch_utils.exceptions.BadConfigException"><code class="xref py py-class docutils literal notranslate"><span class="pre">BadConfigException</span></code></a></p>
<p>Raised when the log level (<cite>log_level</cite>) does not exist</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.BadConfigSparkMasterException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BadConfigSparkMasterException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#BadConfigSparkMasterException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.BadConfigSparkMasterException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.BadConfigException" title="pytorch_utils.exceptions.BadConfigException"><code class="xref py py-class docutils literal notranslate"><span class="pre">BadConfigException</span></code></a></p>
<p>Raised when the Spark master (<cite>spark_master</cite>) is not valid</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.BadConfigPathException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BadConfigPathException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#BadConfigPathException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.BadConfigPathException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.BadConfigException" title="pytorch_utils.exceptions.BadConfigException"><code class="xref py py-class docutils literal notranslate"><span class="pre">BadConfigException</span></code></a></p>
<p>Raised when the configuration path parameter (<cite>conf_path</cite>) does not
contain at least a directory/path where to find configuration files</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.BadConfigMissingInputException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BadConfigMissingInputException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#BadConfigMissingInputException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.BadConfigMissingInputException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.BadConfigException" title="pytorch_utils.exceptions.BadConfigException"><code class="xref py py-class docutils literal notranslate"><span class="pre">BadConfigException</span></code></a></p>
<p>Raised when the ‘input_data’/{‘products’, ‘transactions’} file-path
is missing</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.BadConfigMissingOutputException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BadConfigMissingOutputException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#BadConfigMissingOutputException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.BadConfigMissingOutputException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.BadConfigException" title="pytorch_utils.exceptions.BadConfigException"><code class="xref py py-class docutils literal notranslate"><span class="pre">BadConfigException</span></code></a></p>
<p>Raised when the ‘output_data’/’transactions’ file-path is missing</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.TaskNotFoundError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TaskNotFoundError</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#TaskNotFoundError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.TaskNotFoundError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when task name is not found in entrypoints</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.MissingDatasetError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MissingDatasetError</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#MissingDatasetError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.MissingDatasetError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when a dataset is not found in the catalog</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.DataSetError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DataSetError</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#DataSetError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.DataSetError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when there is an issue with a dataset</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.MissingConfigException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MissingConfigException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#MissingConfigException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.MissingConfigException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when a configuration is missing</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.BadConfigFormatException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BadConfigFormatException</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#BadConfigFormatException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.BadConfigFormatException" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when a configuration is not formatted correctly</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.InconsistentDatasetConfigurations">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InconsistentDatasetConfigurations</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#InconsistentDatasetConfigurations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.InconsistentDatasetConfigurations" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when several inconsistent dataset configurations are being used
to build a dataset.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.NotMonotone">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NotMonotone</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#NotMonotone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.NotMonotone" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when some outputs are not a monotone function of some inputs.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.NotNonDecreasing">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NotNonDecreasing</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#NotNonDecreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.NotNonDecreasing" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when some outputs are not an non-decreasing function of some inputs.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pytorch_utils.exceptions.NotNonIncreasing">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NotNonIncreasing</span></span><a class="reference internal" href="../_modules/pytorch_utils/exceptions.html#NotNonIncreasing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.exceptions.NotNonIncreasing" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pytorch_utils.exceptions.MLError" title="pytorch_utils.exceptions.MLError"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLError</span></code></a></p>
<p>Raised when some outputs are not an non-increasing function of some inputs.</p>
</dd></dl>

</section>
<section id="module-pytorch_utils.metrics">
<span id="pytorch-utils-metrics-module"></span><h2>pytorch_utils.metrics module<a class="headerlink" href="#module-pytorch_utils.metrics" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.metrics.WeightedMeanSquaredError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WeightedMeanSquaredError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">squared</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/metrics.html#WeightedMeanSquaredError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.metrics.WeightedMeanSquaredError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanSquaredError</span></code></p>
<p>Analogue of <cite>torchmetrics.MeanSquaredError</cite> but with (optional) sample weights.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.metrics.WeightedMeanSquaredError.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/metrics.html#WeightedMeanSquaredError.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.metrics.WeightedMeanSquaredError.update" title="Link to this definition"></a></dt>
<dd><p>Update state with predictions and targets.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.metrics.WeightedMeanAbsoluteError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WeightedMeanAbsoluteError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/metrics.html#WeightedMeanAbsoluteError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.metrics.WeightedMeanAbsoluteError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanAbsoluteError</span></code></p>
<p>Analogue of <cite>torchmetrics.MeanAbsoluteError</cite> but with (optional) sample weights.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.metrics.WeightedMeanAbsoluteError.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/metrics.html#WeightedMeanAbsoluteError.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.metrics.WeightedMeanAbsoluteError.update" title="Link to this definition"></a></dt>
<dd><p>Update state with predictions and targets.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.metrics.WeightedBinaryCalibrationError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">WeightedBinaryCalibrationError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'l1'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'l2'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'max'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/metrics.html#WeightedBinaryCalibrationError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.metrics.WeightedBinaryCalibrationError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryCalibrationError</span></code></p>
<p>Analogue of <cite>torchmetrics.classification import BinaryCalibrationError</cite> but with (optional) sample weights.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.metrics.WeightedBinaryCalibrationError.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/metrics.html#WeightedBinaryCalibrationError.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.metrics.WeightedBinaryCalibrationError.update" title="Link to this definition"></a></dt>
<dd><p>Update metric states with predictions and targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.metrics.WeightedBinaryCalibrationError.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/metrics.html#WeightedBinaryCalibrationError.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.metrics.WeightedBinaryCalibrationError.compute" title="Link to this definition"></a></dt>
<dd><p>Compute metric.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.metrics.WeightedBinaryCalibrationError.calibration_curve">
<span class="sig-name descname"><span class="pre">calibration_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">CalibrationDisplay</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/metrics.html#WeightedBinaryCalibrationError.calibration_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.metrics.WeightedBinaryCalibrationError.calibration_curve" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pytorch_utils.miscellaneous">
<span id="pytorch-utils-miscellaneous-module"></span><h2>pytorch_utils.miscellaneous module<a class="headerlink" href="#module-pytorch_utils.miscellaneous" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytorch_utils.miscellaneous.class_full_name">
<span class="sig-name descname"><span class="pre">class_full_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/miscellaneous.html#class_full_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.miscellaneous.class_full_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_utils.miscellaneous.sort_hashable">
<span class="sig-name descname"><span class="pre">sort_hashable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pytorch_utils/miscellaneous.html#sort_hashable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.miscellaneous.sort_hashable" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.miscellaneous.DataclassType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DataclassType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/miscellaneous.html#DataclassType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.miscellaneous.DataclassType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
</dd></dl>

</section>
<section id="module-pytorch_utils.modules">
<span id="pytorch-utils-modules-module"></span><h2>pytorch_utils.modules module<a class="headerlink" href="#module-pytorch_utils.modules" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.LinearNonNeg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinearNonNeg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#LinearNonNeg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.LinearNonNeg" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Linear</span></code></p>
<p>Alternative linear layer with nonnegative weights (bias unchanged).
This ensures the outputs are always a non-decreasing function of the inputs
(no matter the values of parameters <cite>self.weight</cite> and <cite>self.bias</cite>, which may vary during training).</p>
<p>The easiest way to implement this class with minimal code is to subclass <cite>torch.nn.Linear</cite> and
apply a positive transformation (namely <cite>torch.nn.functional.elu</cite> shifted by 1) to the weights
before applying the linear transformation in the <cite>forward</cite> method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.LinearNonNeg.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#LinearNonNeg.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.LinearNonNeg.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.BatchNorm1dNonNeg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BatchNorm1dNonNeg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">track_running_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#BatchNorm1dNonNeg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.BatchNorm1dNonNeg" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BatchNorm1d</span></code></p>
<p>Alternative batch normalization with nonnegative weights (bias unchanged).
This ensures the outputs are always a non-decreasing function of the inputs
when <cite>self.training=False</cite> (no matter the values of parameters <cite>self.weight</cite> and <cite>self.bias</cite>,
which may vary during training).</p>
<p>The easiest way to implement this class with minimal code is to subclass
<cite>torch.nn.BatchNorm1d</cite> and apply a positive transformation (namely <cite>torch.nn.functional.elu</cite> shifted by 1)
to the weights before applying the batch norm transformation in the <cite>forward</cite> method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.BatchNorm1dNonNeg.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#BatchNorm1dNonNeg.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.BatchNorm1dNonNeg.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.LinearSemiNonNeg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LinearSemiNonNeg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features_non_neg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_features_others</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_neg_inputs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'non_neg_inputs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_inputs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'other_inputs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#LinearSemiNonNeg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.LinearSemiNonNeg" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Alternative linear layer combining a standard linear layer (<cite>torch.nn.Linear</cite>)
together with a <cite>LinearNonNeg</cite> layer (by summing the two).
The outputs are always a non-decreasing function of the inputs named <cite>non_neg_inputs_name</cite>
(no matter the weights and biases).
The outputs are not necessarily monotone w.r.t. the inputs named <cite>other_inputs_name</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.LinearSemiNonNeg.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#LinearSemiNonNeg.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.LinearSemiNonNeg.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.BiLinearSemiNonNeg">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BiLinearSemiNonNeg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features_non_neg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_features_others</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features_non_neg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features_others</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_neg_inputs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'non_neg_inputs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_inputs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'other_inputs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#BiLinearSemiNonNeg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.BiLinearSemiNonNeg" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.BiLinearSemiNonNeg.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#BiLinearSemiNonNeg.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.BiLinearSemiNonNeg.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.Partitioned">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Partitioned</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">module_partitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#Partitioned"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.Partitioned" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Unlike <cite>torch.nn.Sequential</cite> wich “chains” outputs to inputs
sequentially for each module in a provided list, this module
simultaneously transforms every partition of the input in parallel
using the corresponding module.
The difference between <cite>torch.nn.Sequential</cite> and <cite>Partitioned</cite> is
similar to the difference between a series and parallel electric circuit.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.Partitioned.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_partitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#Partitioned.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.Partitioned.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.ShiftedEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ShiftedEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_grad_by_freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_freeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#ShiftedEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.ShiftedEmbedding" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></p>
<p>Custom embedding module that shifts all indices by 1.
The original <cite>torch.nn.Embedding</cite> layer only accepts non-negative integers as inputs.
This custom layer accepts non-negative integers and -1 as inputs.
This is useful when -1 is used to encode unknown and/or missing values
(i.e., using a sklearn.preprocessing.OrdinalEncoder with unknown_value=-1 and/or encoded_missing_value=-1).</p>
<p>The easiest way to implement this class with minimal code is to subclass
<cite>torch.nn.Embedding</cite> and shift the inputs by 1 in <cite>forward</cite> method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.ShiftedEmbedding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#ShiftedEmbedding.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.ShiftedEmbedding.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.MeanImputationEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MeanImputationEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_grad_by_freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_freeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MeanImputationEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MeanImputationEmbedding" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Embedding</span></code></p>
<p>Custom embedding module that applies “mean imputation” when inputs negative.</p>
<p>The original <cite>torch.nn.Embedding</cite> layer only accepts non-negative integers as inputs.
This custom layer also accepts negative integers as inputs.
This is useful when for instance -1 is used to encode unknown and/or missing values
(i.e., using a sklearn.preprocessing.OrdinalEncoder with unknown_value=-1 and/or encoded_missing_value=-1).
When a negative input is provided, all embeddings are averaged (form of “mean imputation”).</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MeanImputationEmbedding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MeanImputationEmbedding.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MeanImputationEmbedding.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MonotoneBernoulliProbability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">real_features_non_decreasing:</span> <span class="pre">~typing.List[str],</span> <span class="pre">real_features_non_increasing:</span> <span class="pre">~typing.List[str],</span> <span class="pre">real_features_non_monotone:</span> <span class="pre">~typing.List[str],</span> <span class="pre">categorical_feature_embeddings:</span> <span class="pre">~typing.List[~pytorch_utils.utils.CategoricalFeatureEmbedding]</span> <span class="pre">=</span> <span class="pre">[],</span> <span class="pre">hidden_sizes_monotone:</span> <span class="pre">~typing.List[int]</span> <span class="pre">=</span> <span class="pre">[],</span> <span class="pre">hidden_sizes_non_monotone:</span> <span class="pre">~typing.List[int]</span> <span class="pre">=</span> <span class="pre">[],</span> <span class="pre">polynomial_real_features_expansions:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~typing.List[int]]</span> <span class="pre">=</span> <span class="pre">{},</span> <span class="pre">activation_layer_monotone:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;,</span> <span class="pre">activation_layer_non_monotone:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.activation.ReLU'&gt;,</span> <span class="pre">normalization_layer_monotone:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'pytorch_utils.modules.BatchNorm1dNonNeg'&gt;,</span> <span class="pre">normalization_layer_non_monotone:</span> <span class="pre">~typing.Type[~torch.nn.modules.module.Module]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.batchnorm.BatchNorm1d'&gt;,</span> <span class="pre">dropout_rate_monotone:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">dropout_rate_non_monotone:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">optim_criterion_params:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{'class':</span> <span class="pre">&lt;class</span> <span class="pre">'torch.nn.modules.loss.BCEWithLogitsLoss'&gt;},</span> <span class="pre">optimizer_params:</span> <span class="pre">~typing.Dict[str,</span> <span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{'betas':</span> <span class="pre">(0.9,</span> <span class="pre">0.999),</span> <span class="pre">'class':</span> <span class="pre">&lt;class</span> <span class="pre">'torch.optim.adam.Adam'&gt;,</span> <span class="pre">'eps':</span> <span class="pre">1e-08,</span> <span class="pre">'lr':</span> <span class="pre">0.001},</span> <span class="pre">validation_metrics:</span> <span class="pre">~typing.Mapping[str,</span> <span class="pre">~torchmetrics.metric.Metric]</span> <span class="pre">=</span> <span class="pre">{},</span> <span class="pre">test_metrics:</span> <span class="pre">~typing.Mapping[str,</span> <span class="pre">~torchmetrics.metric.Metric]</span> <span class="pre">=</span> <span class="pre">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>Predicts the probability of success of an event conditioned on some features.
The structure of the neural network enforces that the predicted probability
is a monotone (i.e., non-decreasing and/or non-increasing) function of some specified
features.</p>
<p><cite>optimizer_params</cite> should at least contain the keys <cite>class</cite> and <cite>lr</cite></p>
<dl class="simple">
<dt>Two ways of doing inference:</dt><dd><ul class="simple">
<li><p>use <cite>self.predict</cite> directly</p></li>
<li><p>use method <cite>predict</cite> of <cite>pytorch_lightning.Trainer</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.module_scope">
<span class="sig-name descname"><span class="pre">module_scope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.module_scope" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.learning_rate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learning_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.learning_rate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.forward" title="Link to this definition"></a></dt>
<dd><p>Same as <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.forward()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Whatever you decide to pass into the forward method.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments are also possible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Your model’s output</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.configure_optimizers" title="Link to this definition"></a></dt>
<dd><p>Choose what optimizers and learning-rate schedulers to use in your optimization. Normally you’d need one.
But in the case of GANs or similar you might have multiple. Optimization with multiple optimizers only works in
the manual optimization mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Any of these 6 options.</p>
<ul class="simple">
<li><p><strong>Single optimizer</strong>.</p></li>
<li><p><strong>List or Tuple</strong> of optimizers.</p></li>
<li><p><strong>Two lists</strong> - The first list has multiple optimizers, and the second has multiple LR schedulers
(or multiple <code class="docutils literal notranslate"><span class="pre">lr_scheduler_config</span></code>).</p></li>
<li><p><strong>Dictionary</strong>, with an <code class="docutils literal notranslate"><span class="pre">&quot;optimizer&quot;</span></code> key, and (optionally) a <code class="docutils literal notranslate"><span class="pre">&quot;lr_scheduler&quot;</span></code>
key whose value is a single LR scheduler or <code class="docutils literal notranslate"><span class="pre">lr_scheduler_config</span></code>.</p></li>
<li><p><strong>None</strong> - Fit will run without any optimizer.</p></li>
</ul>
</p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">lr_scheduler_config</span></code> is a dictionary which contains the scheduler and its associated configuration.
The default configuration is shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lr_scheduler_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># REQUIRED: The scheduler instance</span>
    <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="n">lr_scheduler</span><span class="p">,</span>
    <span class="c1"># The unit of the scheduler&#39;s step size, could also be &#39;step&#39;.</span>
    <span class="c1"># &#39;epoch&#39; updates the scheduler on epoch end whereas &#39;step&#39;</span>
    <span class="c1"># updates it after a optimizer update.</span>
    <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;epoch&quot;</span><span class="p">,</span>
    <span class="c1"># How many epochs/steps should pass between calls to</span>
    <span class="c1"># `scheduler.step()`. 1 corresponds to updating the learning</span>
    <span class="c1"># rate after every epoch/step.</span>
    <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="c1"># Metric to to monitor for schedulers like `ReduceLROnPlateau`</span>
    <span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>
    <span class="c1"># If set to `True`, will enforce that the value specified &#39;monitor&#39;</span>
    <span class="c1"># is available when the scheduler is updated, thus stopping</span>
    <span class="c1"># training if not found. If set to `False`, it will only produce a warning</span>
    <span class="s2">&quot;strict&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># If using the `LearningRateMonitor` callback to monitor the</span>
    <span class="c1"># learning rate progress, this keyword can be used to specify</span>
    <span class="c1"># a custom logged name</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When there are schedulers in which the <code class="docutils literal notranslate"><span class="pre">.step()</span></code> method is conditioned on a value, such as the
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.ReduceLROnPlateau</span></code> scheduler, Lightning requires that the
<code class="docutils literal notranslate"><span class="pre">lr_scheduler_config</span></code> contains the keyword <code class="docutils literal notranslate"><span class="pre">&quot;monitor&quot;</span></code> set to the metric name that the scheduler
should be conditioned on.</p>
<p>Metrics can be made available to monitor by simply logging it using
<code class="docutils literal notranslate"><span class="pre">self.log('metric_to_track',</span> <span class="pre">metric_val)</span></code> in your <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some things to know:</p>
<ul class="simple">
<li><p>Lightning calls <code class="docutils literal notranslate"><span class="pre">.backward()</span></code> and <code class="docutils literal notranslate"><span class="pre">.step()</span></code> automatically in case of automatic optimization.</p></li>
<li><p>If a learning rate scheduler is specified in <code class="docutils literal notranslate"><span class="pre">configure_optimizers()</span></code> with key
<code class="docutils literal notranslate"><span class="pre">&quot;interval&quot;</span></code> (default “epoch”) in the scheduler configuration, Lightning will call
the scheduler’s <code class="docutils literal notranslate"><span class="pre">.step()</span></code> method automatically in case of automatic optimization.</p></li>
<li><p>If you use 16-bit precision (<code class="docutils literal notranslate"><span class="pre">precision=16</span></code>), Lightning will automatically handle the optimizer.</p></li>
<li><p>If you use <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.LBFGS</span></code>, Lightning handles the closure function automatically for you.</p></li>
<li><p>If you use multiple optimizers, you will have to switch to ‘manual optimization’ mode and step them
yourself.</p></li>
<li><p>If you need to control how often the optimizer steps, override the <code class="xref py py-meth docutils literal notranslate"><span class="pre">optimizer_step()</span></code> hook.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.training_step" title="Link to this definition"></a></dt>
<dd><p>Here you compute and return the training loss and some additional metrics for e.g. the progress bar or
logger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – The output of your data iterable, normally a <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code>.</p></li>
<li><p><strong>batch_idx</strong> – The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong> – The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> - The loss tensor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - A dictionary which can include any keys, but must include the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code> in the case of
automatic optimization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - In automatic optimization, this will skip to the next batch (but is not supported for
multi-GPU, TPU, or DeepSpeed). For manual optimization, this has no special meaning, as returning
the loss is not required.</p></li>
</ul>
</p>
</dd>
</dl>
<p>In this step you’d normally do the forward pass and calculate the loss for a batch.
You can also do fancier things like multiple forward passes or something model specific.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loss</span>
</pre></div>
</div>
<p>To use multiple optimizers, you can switch to ‘manual optimization’ and control their stepping:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">automatic_optimization</span> <span class="o">=</span> <span class="kc">False</span>


<span class="c1"># Multiple optimizers (e.g.: GANs)</span>
<span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">opt1</span><span class="p">,</span> <span class="n">opt2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizers</span><span class="p">()</span>

    <span class="c1"># do training_step with encoder</span>
    <span class="o">...</span>
    <span class="n">opt1</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="c1"># do training_step with decoder</span>
    <span class="o">...</span>
    <span class="n">opt2</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <code class="docutils literal notranslate"><span class="pre">accumulate_grad_batches</span></code> &gt; 1, the loss returned here will be automatically
normalized by <code class="docutils literal notranslate"><span class="pre">accumulate_grad_batches</span></code> internally.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.validation_step" title="Link to this definition"></a></dt>
<dd><p>Operates on a single batch of data from the validation set. In this step you’d might generate examples or
calculate anything of interest like accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – The output of your data iterable, normally a <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code>.</p></li>
<li><p><strong>batch_idx</strong> – The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong> – The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> - The loss tensor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - A dictionary. Can include any keys, but must include the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - Skip to the next batch.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you have one val dataloader:</span>
<span class="k">def</span> <span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span> <span class="o">...</span>


<span class="c1"># if you have multiple val dataloaders:</span>
<span class="k">def</span> <span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 1: A single validation dataset</span>
<span class="k">def</span> <span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># log 6 example images</span>
    <span class="c1"># or generated text... or whatever</span>
    <span class="n">sample_imgs</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">sample_imgs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s1">&#39;example_images&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">val_acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;val_acc&#39;</span><span class="p">:</span> <span class="n">val_acc</span><span class="p">})</span>
</pre></div>
</div>
<p>If you pass in multiple val dataloaders, <a class="reference internal" href="#pytorch_utils.modules.MonotoneBernoulliProbability.validation_step" title="pytorch_utils.modules.MonotoneBernoulliProbability.validation_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code></a> will have an additional argument. We recommend
setting the default value of 0 so that you can quickly switch between single and multiple dataloaders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 2: multiple validation dataloaders</span>
<span class="k">def</span> <span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># dataloader_idx tells you which dataset this is.</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t need to validate you don’t need to implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the <a class="reference internal" href="#pytorch_utils.modules.MonotoneBernoulliProbability.validation_step" title="pytorch_utils.modules.MonotoneBernoulliProbability.validation_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code></a> is called, the model has been put in eval mode
and PyTorch gradients have been disabled. At the end of validation,
the model goes back to training mode and gradients are enabled.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.test_step" title="Link to this definition"></a></dt>
<dd><p>Operates on a single batch of data from the test set. In this step you’d normally generate examples or
calculate anything of interest such as accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – The output of your data iterable, normally a <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code>.</p></li>
<li><p><strong>batch_idx</strong> – The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong> – The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> - The loss tensor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - A dictionary. Can include any keys, but must include the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - Skip to the next batch.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you have one test dataloader:</span>
<span class="k">def</span> <span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span> <span class="o">...</span>


<span class="c1"># if you have multiple test dataloaders:</span>
<span class="k">def</span> <span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 1: A single test dataset</span>
<span class="k">def</span> <span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># log 6 example images</span>
    <span class="c1"># or generated text... or whatever</span>
    <span class="n">sample_imgs</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">sample_imgs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s1">&#39;example_images&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="s1">&#39;test_loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;test_acc&#39;</span><span class="p">:</span> <span class="n">test_acc</span><span class="p">})</span>
</pre></div>
</div>
<p>If you pass in multiple test dataloaders, <a class="reference internal" href="#pytorch_utils.modules.MonotoneBernoulliProbability.test_step" title="pytorch_utils.modules.MonotoneBernoulliProbability.test_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test_step()</span></code></a> will have an additional argument. We recommend
setting the default value of 0 so that you can quickly switch between single and multiple dataloaders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 2: multiple test dataloaders</span>
<span class="k">def</span> <span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># dataloader_idx tells you which dataset this is.</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t need to test you don’t need to implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the <a class="reference internal" href="#pytorch_utils.modules.MonotoneBernoulliProbability.test_step" title="pytorch_utils.modules.MonotoneBernoulliProbability.test_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test_step()</span></code></a> is called, the model has been put in eval mode and
PyTorch gradients have been disabled. At the end of the test epoch, the model goes back
to training mode and gradients are enabled.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.predict_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.predict_step" title="Link to this definition"></a></dt>
<dd><p>Step function called during <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code>. By default, it calls
<code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code>. Override to add any processing logic.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_step()</span></code> is used
to scale inference on multi-devices.</p>
<p>To prevent an OOM error, it is possible to use <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code>
callback to write the predictions to disk or database after each batch or on epoch end.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code> should be used while using a spawn
based accelerator. This happens for <code class="docutils literal notranslate"><span class="pre">Trainer(strategy=&quot;ddp_spawn&quot;)</span></code>
or training on 8 TPU cores with <code class="docutils literal notranslate"><span class="pre">Trainer(accelerator=&quot;tpu&quot;,</span> <span class="pre">devices=8)</span></code> as predictions won’t be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – The output of your data iterable, normally a <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code>.</p></li>
<li><p><strong>batch_idx</strong> – The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong> – The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted output (optional).</p>
</dd>
</dl>
<p>Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">predict_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="n">dm</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;gpu&quot;</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.predict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.predict_from_pandas">
<span class="sig-name descname"><span class="pre">predict_from_pandas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule"><span class="pre">AugmentedBernoulliDataModule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling_factors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([1.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_augmented_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_augmented_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.predict_from_pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.predict_from_pandas" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.probability_mapping">
<span class="sig-name descname"><span class="pre">probability_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule"><span class="pre">AugmentedBernoulliDataModule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.probability_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.probability_mapping" title="Link to this definition"></a></dt>
<dd><p>Computes the mapping between covariate <cite>data_module.augmented_col</cite> and the predicted probability
of the neural network on the closed interval <cite>[min_value, max_value]</cite>,
all <cite>other_features</cite> being fixed.
The mapping is discretized into <cite>nb_points</cite> points.</p>
<p>There are two ways to use this function:
- call with <cite>trainer=None</cite> =&gt; method <cite>self.predict</cite> is used directly for
inference
- call with <cite>trainer=pytorch_lightning.Trainer(…)</cite> =&gt; method <cite>predict</cite> of
<cite>pytorch_lightning.Trainer</cite> is used for inference</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.assert_monotone_probability">
<span class="sig-name descname"><span class="pre">assert_monotone_probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule"><span class="pre">AugmentedBernoulliDataModule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_decreasing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.assert_monotone_probability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.assert_monotone_probability" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.MonotoneBernoulliProbability.plot_probability_mapping">
<span class="sig-name descname"><span class="pre">plot_probability_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pytorch_utils.data_modules.AugmentedBernoulliDataModule" title="pytorch_utils.data_modules.AugmentedBernoulliDataModule"><span class="pre">AugmentedBernoulliDataModule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Covariate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Predicted</span> <span class="pre">probability'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Evolution</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">predicted</span> <span class="pre">probability</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">function</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">covariate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Figure</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#MonotoneBernoulliProbability.plot_probability_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.MonotoneBernoulliProbability.plot_probability_mapping" title="Link to this definition"></a></dt>
<dd><p>Plots the mapping between covariate <cite>data_module.augmented_col</cite> and the predicted probability
of the neural network on the closed interval <cite>[min_value, max_value]</cite>,
all <cite>other_features</cite> being fixed.
The mapping is discretized into <cite>nb_points</cite> points.</p>
<p>There are two ways to use this function:
- call with <cite>trainer=None</cite> =&gt; method <cite>self.predict</cite> is used directly for
inference
- call with <cite>trainer=pytorch_lightning.Trainer(…)</cite> =&gt; method <cite>predict</cite> of
<cite>pytorch_lightning.Trainer</cite> is used for inference</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.modules.ProbabilityPredictor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ProbabilityPredictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataModule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#ProbabilityPredictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.ProbabilityPredictor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">DataModule</span></code>]</p>
<p>Just a pair <cite>(MonotoneBernoulliProbability, AugmentedBernoulliDataModule)</cite>
with useful methods such as <cite>predict_from_pandas</cite>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.modules.ProbabilityPredictor.module">
<span class="sig-name descname"><span class="pre">module</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Module</span></em><a class="headerlink" href="#pytorch_utils.modules.ProbabilityPredictor.module" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.modules.ProbabilityPredictor.data_module">
<span class="sig-name descname"><span class="pre">data_module</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataModule</span></em><a class="headerlink" href="#pytorch_utils.modules.ProbabilityPredictor.data_module" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.ProbabilityPredictor.load_from_checkpoint">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_from_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_class:</span> <span class="pre">~typing.Type[~pytorch_utils.modules.Module]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'pytorch_utils.modules.MonotoneBernoulliProbability'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_module_class:</span> <span class="pre">~typing.Type[~pytorch_utils.modules.DataModule]</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'pytorch_utils.data_modules.AugmentedBernoulliDataModule'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_data:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compile_module:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compilation_kwargs:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Any]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pytorch_utils.modules.ProbabilityPredictor" title="pytorch_utils.modules.ProbabilityPredictor"><span class="pre">ProbabilityPredictor</span></a></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#ProbabilityPredictor.load_from_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.ProbabilityPredictor.load_from_checkpoint" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.ProbabilityPredictor.clear_data">
<span class="sig-name descname"><span class="pre">clear_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pytorch_utils.modules.ProbabilityPredictor" title="pytorch_utils.modules.ProbabilityPredictor"><span class="pre">ProbabilityPredictor</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Module</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataModule</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#ProbabilityPredictor.clear_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.ProbabilityPredictor.clear_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.modules.ProbabilityPredictor.predict_from_pandas">
<span class="sig-name descname"><span class="pre">predict_from_pandas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/modules.html#ProbabilityPredictor.predict_from_pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.modules.ProbabilityPredictor.predict_from_pandas" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-pytorch_utils.utils">
<span id="pytorch-utils-utils-module"></span><h2>pytorch_utils.utils module<a class="headerlink" href="#module-pytorch_utils.utils" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytorch_utils.utils.CategoricalFeatureEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CategoricalFeatureEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_name:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_distinct_values:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_size:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger:</span> <span class="pre">~pytorch_utils.logging.loggers.Logger</span> <span class="pre">=</span> <span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytorch_utils/utils.html#CategoricalFeatureEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.utils.CategoricalFeatureEmbedding" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Collection that simplifies the constructor parameters.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.utils.CategoricalFeatureEmbedding.feature_name">
<span class="sig-name descname"><span class="pre">feature_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#pytorch_utils.utils.CategoricalFeatureEmbedding.feature_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.utils.CategoricalFeatureEmbedding.nb_distinct_values">
<span class="sig-name descname"><span class="pre">nb_distinct_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pytorch_utils.utils.CategoricalFeatureEmbedding.nb_distinct_values" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.utils.CategoricalFeatureEmbedding.embedding_size">
<span class="sig-name descname"><span class="pre">embedding_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pytorch_utils.utils.CategoricalFeatureEmbedding.embedding_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytorch_utils.utils.CategoricalFeatureEmbedding.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Logger</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;pytorch_utils.logging.loggers.VoidLogger</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#pytorch_utils.utils.CategoricalFeatureEmbedding.logger" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytorch_utils.utils.CategoricalFeatureEmbedding.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/utils.html#CategoricalFeatureEmbedding.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.utils.CategoricalFeatureEmbedding.log" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_utils.utils.get_embedding_size">
<span class="sig-name descname"><span class="pre">get_embedding_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicative_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power_exponent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.56</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">600</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/utils.html#get_embedding_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.utils.get_embedding_size" title="Link to this definition"></a></dt>
<dd><p>Determine empirically good embedding sizes (formula taken from fastai: <a class="reference external" href="https://docs.fast.ai/tabular.model.html">https://docs.fast.ai/tabular.model.html</a>).
:param nb_categories: number of categories
:type nb_categories: int
:param max_size: maximum embedding size. Defaults to 600.
:type max_size: (int, optional)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>embedding size</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytorch_utils.utils.assert_monotone">
<span class="sig-name descname"><span class="pre">assert_monotone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_decreasing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pytorch_utils/utils.html#assert_monotone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytorch_utils.utils.assert_monotone" title="Link to this definition"></a></dt>
<dd><p>Asserts if the <cite>outputs</cite> are a monontone function of the <cite>inputs</cite>.
<cite>inputs</cite> should be a 1-dimensional.
<cite>outputs</cite> should be a 1 or 2-dimensional array. If 2-dimensional,
then every row is tested to be a monotone function of the inputs.
If <cite>non_decreasing</cite> is <cite>None</cite> then an exception is raised only if the mapping
is neither non-decreasing, nor non-increasing.
If <cite>non_decreasing</cite> is <cite>True</cite> then an exception is raised only if the mapping
is not non-decreasing.
If <cite>non_decreasing</cite> is <cite>False</cite> then an exception is raised only if the mapping
is not non-increasing.</p>
</dd></dl>

</section>
<section id="module-pytorch_utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pytorch_utils" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="pytorch_utils" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, AI-Helpers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>